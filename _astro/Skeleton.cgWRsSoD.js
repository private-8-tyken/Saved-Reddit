import{j as c}from"./jsx-runtime.D_zvdyIk.js";import"./index.RH_Wq4ov.js";const x="sr__v2__favorites",F=typeof window<"u",b=F&&typeof window.localStorage<"u";let d=null;function N(){try{typeof window<"u"&&window.dispatchEvent(new Event("favorites:changed"))}catch{}}function V(n,t){try{return JSON.parse(n)}catch{return t}}function g(){if(!b)return{};if(d)return d;const n=window.localStorage.getItem(x),t=V(n,{});if(!t||typeof t!="object")return d={},d;for(const i of Object.keys(t)){const e=t[i];(!e||typeof e.ts!="number")&&delete t[i]}return d=t,d}function O(n){if(b){d=n||{};try{window.localStorage.setItem(x,JSON.stringify(d))}catch{}N()}}function k(){const n=g();return new Map(Object.entries(n))}function D(){return new Set(Object.keys(g()))}function B(n){const t=new Set(n||[]),i={...g()};for(const e of Object.keys(i))t.has(e)||delete i[e];for(const e of t)i[e]||(i[e]={ts:Date.now()});O(i)}function C(){const n=[["id","timestamp"]];for(const[e,l]of k().entries()){const w=new Date(l.ts||Date.now()).toISOString();n.push([e,w])}const t=e=>{const l=String(e??"");return/[",\n]/.test(l)?`"${l.replace(/"/g,'""')}"`:l};return n.map(e=>e.map(t).join(",")).join(`
`)}function _(n){let t=0,i=0,e=0;if(typeof n!="string"||!n.trim())return{added:t,alreadyHad:i,invalid:e};function l(r){const u=[];let s=0,o="",a=[],y=!1;for(;s<r.length;){const f=r[s++];y?f==='"'?r[s]==='"'?(o+='"',s++):y=!1:o+=f:f==='"'?y=!0:f===","?(a.push(o),o=""):f===`
`||f==="\r"?(f==="\r"&&r[s]===`
`&&s++,a.push(o),o="",(a.length>1||a[0]!=="")&&u.push(a),a=[]):o+=f}return(o.length||a.length)&&(a.push(o),u.push(a)),u}const w=l(n).filter(r=>r.length>0);if(!w.length)return{added:t,alreadyHad:i,invalid:e};const S=w[0].map(r=>String(r||"").trim().toLowerCase());let j=0,v=0,p=1;S.includes("id")&&(v=S.indexOf("id"),p=S.indexOf("timestamp"),j=1);const h={...g()};for(let r=j;r<w.length;r++){const u=w[r],s=String(u[v]||"").trim();if(!s){e++;continue}let o=Date.now();if(p>=0&&u[p]){const a=new Date(String(u[p]).trim());isNaN(a.getTime())||(o=a.getTime())}h[s]?((typeof h[s].ts!="number"||o<h[s].ts)&&(h[s].ts=o),i++):(h[s]={ts:o},t++)}return O(h),{added:t,alreadyHad:i,invalid:e}}typeof window<"u"&&(window.SR=window.SR||{},window.SR.exportFavoritesCSV=C,window.SR.importFavoritesCSV=_);function m({h:n=16,w:t="100%",style:i={}}){return c.jsx("div",{className:"skeleton",style:{height:n,width:t,...i},"aria-hidden":"true"})}function E(){return c.jsxs("div",{className:"card",style:{marginBottom:12},"aria-busy":"true",children:[c.jsx(m,{h:180,style:{marginBottom:8}}),c.jsx(m,{h:18,w:"80%",style:{margin:"6px 0"}}),c.jsx(m,{h:14,w:"40%"})]})}function J(){return c.jsx("div",{className:"container",children:c.jsxs("div",{className:"card",style:{marginBottom:12},"aria-busy":"true",children:[c.jsx(m,{h:28,w:"70%",style:{margin:"6px 0"}}),c.jsx(m,{h:14,w:"40%",style:{marginBottom:8}}),c.jsx(m,{h:220})]})})}export{J as P,E as S,D as l,B as s};
