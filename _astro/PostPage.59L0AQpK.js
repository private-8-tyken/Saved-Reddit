import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.RH_Wq4ov.js";import{l as v,P as g,s as y}from"./Skeleton.rCBg4tsF.js";function x({c:r,depth:s=0}){const[i,l]=o.useState(!0);return e.jsxs("div",{style:{marginLeft:s?12:0,borderLeft:s?"1px solid var(--border)":"none",paddingLeft:s?10:0,marginTop:8},children:[e.jsxs("div",{className:"meta",children:[r.author||"[deleted]"," • ",r.score??0," pts",e.jsx("button",{className:"button",style:{marginLeft:8,padding:"4px 8px"},onClick:()=>l(n=>!n),children:i?"Collapse":"Expand"})]}),i&&e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:6},children:r.body}),i&&Array.isArray(r.replies)&&r.replies.map(n=>e.jsx(x,{c:n,depth:s+1},n.id))]})}function N({comments:r}){return!r||!r.length?e.jsx("div",{className:"meta",children:"No comments."}):e.jsx("div",{children:r.map(s=>e.jsx(x,{c:s},s.id))})}const c="/Saved-Reddit/",d=c.endsWith("/")?c:c+"/";function S({id:r}){const[s,i]=o.useState(null),[l,n]=o.useState(null),[m,h]=o.useState(new Set),u=m.has(r),j=()=>{const t=new Set(m);u?t.delete(r):t.add(r),h(t),y(t)};if(o.useEffect(()=>{let t=!0;return n(null),i(null),fetch(`${d}data/posts/${r}.json`).then(a=>{if(!a.ok)throw new Error(`HTTP ${a.status}`);return a.json()}).then(a=>{t&&i(a)}).catch(a=>{t&&n(a.message||"Failed to load")}),()=>{t=!1}},[r]),o.useEffect(()=>{h(v())},[]),l)return e.jsx("div",{className:"container",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"Post not found"}),e.jsx("div",{className:"meta",children:l}),e.jsx("div",{className:"row",style:{marginTop:8},children:e.jsx("button",{className:"button",onClick:()=>history.length>1?window.history.back():window.location.href=d,children:"← Back"})})]})});if(!s&&!l)return e.jsx(g,{});const p=[s.link_flair_text||s.flair||"",s.subreddit?`r/${s.subreddit}`:"",s.author?`u/${s.author}`:""].filter(Boolean).join(" • "),f=(()=>{const t=s.media;if(!t)return null;if(t.video?.url)return e.jsx("video",{src:t.video.url,poster:t.video.poster||"",style:{width:"100%",borderRadius:10},controls:!0});if(Array.isArray(t.items)&&t.items.length){const a=t.items[0];return e.jsx("img",{src:a.url,alt:"",style:{width:"100%",borderRadius:10},loading:"lazy"})}return null})();return!s&&!l?e.jsx("div",{className:"container",children:e.jsxs("div",{className:"card",style:{marginBottom:12},children:[e.jsx("div",{className:"skeleton",style:{height:28,width:"70%",margin:"6px 0"}}),e.jsx("div",{className:"skeleton",style:{height:14,width:"40%",marginBottom:8}}),e.jsx("div",{className:"skeleton",style:{height:220}})]})}):e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"row",style:{marginTop:12,marginBottom:8},children:[e.jsx("button",{className:"button",onClick:()=>history.length>1?window.history.back():window.location.href=d,children:"← Back"}),e.jsx("button",{className:"button",onClick:j,children:u?"⭐ Unstar":"☆ Star"}),s.permalink&&e.jsx("a",{className:"button",href:s.permalink,target:"_blank",rel:"noopener noreferrer",children:"Open on Reddit ↗"})]}),e.jsxs("article",{className:"card",children:[e.jsx("h2",{style:{marginTop:0},children:s.title}),e.jsx("div",{className:"meta",children:p}),e.jsx("hr",{className:"sep"}),f,s.selftext&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"sep"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:s.selftext})]})]}),e.jsx("h3",{style:{marginTop:16},children:"Comments"}),e.jsx("article",{className:"card",children:e.jsx(N,{comments:s.comments||[]})})]})}export{S as default};
